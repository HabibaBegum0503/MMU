function onEmailEnter(n){isValidEmailAddress($(n).val())?$(n).addClass("custom-invalid-field"):$(n).removeClass("custom-invalid-field")}function isValidEmailAddress(n){return/(['])/.test(n)}function ProjectActionAdd(){$(".view-projects > a").attr("href","/Project/List")}function clearModalBody(n){$(n).find(".modal-body *").children().remove();$(n).find(".modal-footer .are-you-sure").remove();$(n).find(".modal-footer").css("height","");$(n).find(":input").removeAttr("disabled");$(n).find("#action").unbind()}function areYouSureSetup(n,t,i){var r=$(document.createElement("div")),f=$(document.createElement("div")),e=$(document.createElement("button")),u=$(document.createElement("button"));$(r).addClass("auto-margin are-you-sure");$(e).addClass("btn btn-success").html(Yes);$(u).addClass("btn btn-danger").html(No);$(f).html(Sure_Action);i&&$(f).html(Sure_Delete);$(e).click(function(){$(this).attr("disabled","true");$(u).attr("disabled","true");$(this).html(Loading);t()});$(u).click(function(){$(n).find(".modal-body :input").removeAttr("disabled");$(n).find(".modal-footer .main-action:input").removeAttr("disabled");$(n).find(".modal-footer").animate({height:"30px"},300);$(n).find(".are-you-sure").remove()});$(r).append(f);$(r).append(e);$(r).append(u);$(n).find(".modal-body :input").attr("disabled","true");$(n).find(".modal-footer .main-action:input").attr("disabled","true");$(n).find(".modal-footer").animate({height:"120px"},500);$(n).find(".modal-footer").append(r)}function workareaFeedback(n,t){$("#actionbar-modal").modal("hide");n=="success"?$("#workarea-feedback").addClass("successful"):n=="failure"&&$("#workarea-feedback").addClass("failure");$("#workarea-feedback > span").text(t);$("#workarea-feedback").fadeIn(400,function(){setTimeout(function(){$("#workarea-feedback").fadeOut(400)},3e3)})}function fillActionBarModal(n,t,i,r,u,f){var o=$("#actionbar-modal > .modal-header > h3"),s=$("#actionbar-modal .modal-body"),e=$("#actionbar-modal .modal-footer #action");$(o).html(n);$(s).append(t);$(e).html(i);e.show();$(e).click(function(){u()&&(f?areYouSureSetup($("#actionbar-modal"),r,!0):r())})}function fillActionBarEmptyModal(n,t,i){var u=$("#actionbar-modal > .modal-header > h3"),f=$("#actionbar-modal .modal-body"),r=$("#actionbar-modal .modal-footer #action");buttonText=View_Form;$(u).html(n);$(f).html(t);i!=null||i!=undefined?(r.show().text(buttonText),r.bind("click",function(){window.location.href=i})):r.hide()}function reloadTiles(){NotificationActionAdd()}function SetUpUpgradeButtonHandler(){$("#upgrade-btn").on("click",function(){$.ajax({type:"POST",url:"/Project/GetUpgradeDescription",success:function(n){$("#projectdescription").html(n);$("#createbutton").off("click").on("click",function(){if(ProjectSubmitStatus.isSubmitting)return!1;ProjectSubmitStatus.isSubmitting=!0})},error:function(){showFeedback("failure","@ReviewResources.Unable_to_get_update_description");$("#projectdescription").text("@ReviewResources.Update_description_unavailable").css("color","red")}});$("#upgrade-project-overlay").modal("show")})}function addExtraEmptyLinks(n){var s=$(window).width(),i=s<twoColumnWidth?!0:!1,h=$(n).find("li:visible"),r=h.length,u=0,f,e,t,o;for(i&&r%2==1?u=1:i==!1&&r%3!=0&&(u=3-r%3),f=0;f<u;f++)e=document.createElement("li"),$(e).addClass("emptyLi"),$(n).append(e);t=$(n).find(".emptyLi");o=t.length;i?o==2&&$(t).remove():o==3&&$(t).remove()}function getTodaysDate(){var n=new Date,t=n.getDate(),i=n.getMonth()+1,r=n.getFullYear();t<10&&(t="0"+t);i<10&&(i="0"+i);n=i+"/"+t+"/"+r;document.write(n)}function showFeedback(n,t){var r=$.Deferred(),i=$("#feedback");return i.hide().removeClass("inProgress"),n=="success"?(i.removeClass("failure"),i.removeClass("warning"),i.addClass("successful")):n=="failure"?(i.removeClass("successful"),i.removeClass("warning"),i.addClass("failure")):n=="warning"&&(i.removeClass("successful"),i.removeClass("failure"),i.addClass("warning")),$("#feedback > span").text(t),i.fadeIn(400,function(){setTimeout(function(){i.fadeOut(400,function(){$("#feedback > span").text("");r.resolve()})},4e3)}),r.promise()}function showInProgressFeedback(n){var t=$("#feedback");$("#feedback > span").text(n);t.removeClass("successful").removeClass("failure").addClass("inProgress").fadeIn(400)}function DataTablesInitClientside(n){function t(n,t){return function(i,r){return $.map(i.oApi._fnGetTrNodes(i),function(i){try{var u=n(i,r);return u=$.trim(u),t(u)}catch(f){return""}})}}function s(n,t){return $("td:eq("+t+")",n).text()}function h(n,t){return $("td:eq("+t+")",n).attr("data-sort")}function u(n){if(n=="")return n;var t=n.split(" "),i=t[0].split("/");return i.length==1&&(i=t[0].split("-")),i.reverse().join("/")+" "+t.slice(1).join(" ")}function c(n,t){return($("td:eq("+t+') input[type="checkbox"]:checked',n).length>0).toString()}function f(n){return n=="true"?"A":"Z"}function l(n,t){var i=$("td:eq("+t+")",n),r=i.find(".existing.True").length;return(r>0).toString()}function a(n){for(var t,i=0;i<n.length;i++)t=n[i],t.bUkDate&&(t.sSortDataType="UkDateSort"),t.UkDateSortAttribute&&(t.sSortDataType="UkDateSortAttribute"),t.bCheckbox&&(t.sSortDataType="CheckboxSort"),t.bTickCross&&(t.sSortDataType="TickCrossSort"),t.bType!==undefined&&(t.sType=t.bType);return n}var e,i,r,o;return $.fn.dataTableExt.afnSortData.UkDateSort=t(s,u),$.fn.dataTableExt.afnSortData.UkDateSortAttribute=t(h,u),$.fn.dataTableExt.afnSortData.CheckboxSort=t(c,f),$.fn.dataTableExt.afnSortData.TickCrossSort=t(l,f),e=n.noneFoundMsg==null?"No items found":n.noneFoundMsg,i=n.aaSorting,i==null&&(i=[]),r=n.bFilter,r==null&&(r=!0),o=$(n.tableSelector).dataTable({bPaginate:!1,bLengthChange:!1,bFilter:r,bSort:!0,bSortClasses:!1,bInfo:!1,bAutoWidth:!0,aaSorting:i,aoColumns:a(n.aoColumns),oLanguage:{sSearch:"",sZeroRecords:e}}),$(".dataTables_filter input").addClass("search-query").attr("placeholder",n.searchPlaceholder),o}function ValidateInputsWithinContainer(n){var i=n.find(".mandatory:input"),t=!0;return $.each(i,function(n,i){function u(n,i){t=!1;n.addClass("invalid");var r=i+".validation";n.off(r).on(r,function(){n.removeClass("invalid")})}var r=$(i),f=i.type;r.val().trim()==""?u(r,"keydown"):i.type=="select-one"&&r.val()==0&&u(r,"change")}),t}function ClearValidationErrors(n){n.find(".mandatory:input").removeClass("invalid")}function AddLeadingZeros(n,t){for(var r=(n>0?n:-n)+"",i="",u=t-r.length;u>0;u--)i+="0";return i+=r,n>=0?i:"-"+i}function occurrences(n,t,i){if(n+="",t+="",t.length<=0)return n.length+1;for(var u=0,r=0,f=i?1:t.length;;)if(r=n.indexOf(t,r),r>=0)u++,r+=f;else break;return u}function InitKendoEditor(n,t,i,r,u,f,e,o){function h(){return w(),i!=null&&(s.stylesheets=i),s.tools=c(),f!=null&&(s.select=f),s.keyup=y,s.keydown=v,(t=="admin"||t=="image")&&l(),s}function c(){var r=[],f,n,i;return t=="none"?r:t=="image"?["insertImage"]:(f=["bold","italic","underline","separator","strikethrough",{name:"fontName",items:[{text:"Arial",value:"Arial,Helvetica,sans-serif"},{text:"Cambria",value:"Cambria,Times,serif"},{text:"Courier New",value:"'Courier New',Courier,monospace"},{text:"Georgia",value:"Georgia,serif"},{text:"Impact",value:"Impact,Charcoal,sans-serif"},{text:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{text:"Times New Roman",value:"'Times New Roman',Times,serif"},{text:"Trebuchet MS",value:"'Trebuchet MS',Helvetica,sans-serif"},{text:"Verdana",value:"Verdana,Geneva,sans-serif"}]},"fontSize","foreColor","backColor","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","formatting","subscript","superscript","createTable","addColumnLeft","addColumnRight","addRowAbove","addRowBelow","deleteRow","deleteColumn"],n=[],t=="admin"&&(n=["createLink","unlink","insertImage","viewHtml"]),i=[],u!=null&&(i=[{name:"save",tooltip:"Save",exec:u}]),r.concat(f,n,i))}function l(){s.imageBrowser={transport:{read:"/ImageBrowser/Read",thumbnailUrl:"/ImageBrowser/Thumbnail",uploadUrl:"/ImageBrowser/Upload",imageUrl:"/ImageBrowser/Image?path={0}",destroy:{url:"/ImageBrowser/Destroy",type:"POST"},create:{url:"/ImageBrowser/Create",type:"POST"}}}}function a(){try{return $(n).data("kendoEditor")}catch(t){return null}}function v(n){o!=null&&o(n)}function y(n){n.keyCode==13&&n.shiftKey==!1&&p(n);e!=null&&e(n)}function p(){}function w(){var n=kendo.ui.editor,t=n.EditorUtils.registerTool,i=n.Tool;t("insertLineBreak",new i({key:13,command:n.NewLineCommand}));t("insertParagraph",new i({key:13,shift:!0,command:n.ParagraphCommand}))}var s={};return h(),r!=null&&(s.value=r),$(n).kendoEditor(s),a()}function InitPageHelp(){$(".page-help").click(function(n){var t=$(this);n.stopPropagation();$.getJSON("/HelpPanel/GetHelpPanel/",{helpPanelId:$(t).attr("data-id")},function(n){n&&($("#helpOverlay .modal-body #accordion-container").html(n.Content),$("#helpOverlay").modal("show"),$("#accordion > h3").length>1?$("#accordion").accordion({collapsible:!0,heightStyle:"content",active:!1}):$("#accordion > h3").length==1&&$("#accordion").accordion({collapsible:!0,heightStyle:"content"}),$("#help-search").keyup(function(){var n=$(this).val().toLowerCase();$.each($("#accordion .ui-accordion-header"),function(t,i){$(i).text().toLowerCase().indexOf(n)==-1?$(i).hide():$(i).show()})}))})})}function findOne(n,t){return t.some(function(t){return n.indexOf(t)>=0})}function RefreshCorrespondance(){getCorrespondence().then(function(n){$("#form-correspondence-container").html(n)})}function RefreshCorrespondenceReview(){var n=$("#correspondence-form"),t=n.find('input[name="correspondenceRequestPage"]').val(),i;if(t==1)i=n.find('input[name="userProjectId"]').val(),getCorrespondenceTab(i,0,t);else if(t==2){var i=n.find('input[name="userProjectId"]').val(),r=n.find('input[name="submissionId"]').val(),u=n.find('input[name="userProjectFormId"]').val();$("#correspondence-checkbox").is(":checked")?getCorrespondenceTab(i,r,t,u):getCorrespondenceTab(i,r,t)}}function getCorrespondenceMessageModal(n,t){$.ajax({type:"GET",data:{correspondenceId:n,correspondenceRequestPage:t},url:"/Correspondence/GetCorrespondence",success:function(n){$("#correspondence-message-modal-container").html(n);$("#correspondence-message-overlay").modal("show")},error:function(n,t,i){console.log(n.status);console.log(i)}})}function timelineFeedback(n,t){n=="success"?$("#timeline-feedback").addClass("successful"):n=="failure"&&$("#timeline-feedback").addClass("failure");$("#timeline-feedback > span").text(t);$("#timeline-feedback").fadeIn(400,function(){setTimeout(function(){$("#timeline-feedback").fadeOut(400)},3e3)})}var IsPageContaintNotificationTile=$("#IsPageContaintNotificationTile").length,shared,validationModule;$(document).ready(function(){$("#load-overlay-pane").hide();$("input[type='email']:enabled").each(function(){$(this).on("keyup",function(){onEmailEnter(this)})})});$(window).bind("beforeunload",function(){});var twoColumnWidth=1281,eConditions={emCommon:0,emTextContains:1,emTextDoesNotContain:2,emDateAfter:3,emDateBefore:4,emDateIn:5,emDateNotIn:6,emNumberUp:7,emNumberDown:8,emYesterday:9,emToday:10,emTomorrow:11,emNext7Days:12,emLast7Days:13,emNextWeek:14,emLastWeek:15,emThisWeek:16,emNextMonth:17,emLastMonth:18,emThisMonth:19,emNextYear:20,emLastYear:21,emThisYear:22,emLastXHours:23,emNextXHours:24,emLastXDays:25,emNextXDays:26,emLastXMonths:27,emNextXMonths:28,emLastXYears:29,emNextXYears:30,emNotNextXDays:32},ProjectSubmitStatus={isSubmitting:!1};Array.prototype.contains=function(n){for(var t=this.length;t--;)if(this[t]===n)return!0;return!1};String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})};shared={generateGuId:function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)})},ajaxDocumentUploader:function(n,t){var i=$("#load-overlay-pane");i.show();var r=document.getElementById(n),f=document.getElementsByName("correspondence-file"),u=!1;$(r).find("input[type=file]").val()!=""&&$(r).find(".progress").show();window.FormData&&(u=new FormData(r));u&&(u.append("notifyAll",$("#checkNotifyAll").is(":checked")),$.ajax({url:"/correspondence/SendCorrespondence/",type:"POST",xhr:function(){var n=$.ajaxSettings.xhr();return n.upload&&(n.upload.form=r,n.upload.addEventListener("progress",shared.ajaxProgressHandler,!1)),n},data:u,processData:!1,contentType:!1,success:function(n){n.Success?(t?(FeedbackSuccess(Correspondence_Sent),RefreshCorrespondenceReview()):(showFeedback("success",Correspondence_Sent),RefreshCorrespondance()),i.hide(),$(".modal").modal("hide"),$("#correspondence-form")[0].reset()):(t?FeedbackError(n.Error):showFeedback("failure",n.Error),i.hide())},error:function(){i.hide()}}))},ajaxProgressHandler:function(n){var t=n.target.form,i,r;n.lengthComputable&&($(t).find(".progress").attr({value:n.loaded,max:n.total}),i=n.loaded/n.total*100+"%",$(t).find(".progress .bar").css("width",i),i=="100%"&&(r=setTimeout(function(){$(t).find(".progress .bar").addClass("bar-success")},700)))},formFunctions:{initializeFormDependencies:function(n){var i=$("#"+n),t=[];i.find(".control-group[data-dependentOn]").each(function(n,i){var u=$(i),r=u.attr("data-dependentOn");t.indexOf(r)==-1&&t.push(r)});$.each(t,function(n,t){var r=$("#"+t);r.change(function(){var r=i.find('.control-group[data-dependentOn="'+t+'"]'),n=$(this);r.each(function(t,i){var r=$(i),u=r.attr("data-dependencyValue");isNaN(parseInt(u))?JSON.parse(u).indexOf(parseInt(n.val()))>-1?(r.show(),r.removeClass("hidden-by-dependency").addClass("shown-by-dependency"),r.find(":input.form-control").removeClass("hidden-by-dependency").addClass("shown-by-dependency")):(r.hide(),r.removeClass("shown-by-dependency").addClass("hidden-by-dependency"),r.find(":input.form-control").removeClass("shown-by-dependency").addClass("hidden-by-dependency"),r.find(":input.form-control.hidden-by-dependency").val("").trigger("chosen:updated")):u==n.val()?(r.show(),r.removeClass("hidden-by-dependency").addClass("shown-by-dependency"),r.find(":input.form-control").removeClass("hidden-by-dependency").addClass("shown-by-dependency")):(r.hide(),r.removeClass("shown-by-dependency").addClass("hidden-by-dependency"),r.find(":input.form-control").removeClass("shown-by-dependency").addClass("hidden-by-dependency"),r.find(":input.form-control.hidden-by-dependency").val("").trigger("chosen:updated"))})});r.val()!=null&&r.val()>0&&r.val()!=""&&r.change()})}}};validationModule=function(){var u=function(n){n.classList.remove("error");n.querySelectorAll(".help-inline, .help-block").forEach(function(n){n.innerHTML=""})},n=function(n){n.querySelectorAll(".control-group").forEach(function(n){u(n)})},f=function(n){for(var i=$.parseJSON(n),r=[],t=0;t<i.length;t++)r.push(new e(i[t].PropertyName,i[t].Message));return r},e=function(n,t){this.FieldName=n;this.ErrorMessage=t},o=function(n,t){for(var e,o,s,u=f(t),i=0;i<u.length;i++)e=$(n).find(":input[name="+u[i].FieldName+"]").first(),e!=null&&(o=e.closest(".control-group"),s=o.find(".help-inline, .help-block"),o.addClass("error"),s.html(u[i].ErrorMessage));r(n)},s=function(n,t){t.forEach(function(t){var r=$(n).find(":input[name="+t.FieldName+"]").first(),f=t.Errors[0],i,u;r!=null&&(i=r.closest(".control-group"),u=i.find(".help-inline, .help-block"),i.addClass("error"),u.html(f.ErrorMessage))})},t=function(t){var f=$(t),e=f.serialize(),i=[],u=$.Deferred();return $.ajax({url:t.getAttribute("action"),headers:{ValidateModel:"true"},data:e,type:"POST",dataType:"json"}).success(function(){n(t);u.resolve(i)}).error(function(f){var e=JSON.parse(f.responseText),o=Object.keys(e);n(t);o.forEach(function(n){var t=e[n];e[n].Errors&&e[n].Errors.length>0&&i.push({FieldName:n,Errors:t.Errors,Value:t.Value})});i.length>0&&(s(t,i),r(t));u.resolve(i)}),u.promise()},i=function(n){t(n.data.formToValidate)},r=function(n){var t=$(n).find(".control-group");t.each(function(t,r){$(r).find(":input").off("change",i).on("change",{formToValidate:n},i)})};return{validateForm:t,renderDomainErrorMessages:o}}()